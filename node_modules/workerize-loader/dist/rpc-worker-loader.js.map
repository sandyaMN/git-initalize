{"version":3,"file":"rpc-worker-loader.js","sources":["../src/rpc-worker-loader.js"],"sourcesContent":["/* global __webpack_exports__ */\n\nfunction workerSetup() {\n\taddEventListener('message', (e) => {\n\t\tlet { type, method, id, params } = e.data, f, p;\n\t\tif (type==='RPC' && method) {\n\t\t\tif ((f = __webpack_exports__[method])) {\n\t\t\t\tp = Promise.resolve().then( () => f.apply(__webpack_exports__, params) );\n\t\t\t}\n\t\t\telse {\n\t\t\t\tp = Promise.reject('No such method');\n\t\t\t}\n\t\t\tp.then(result => {\n\t\t\t\t\tpostMessage({ type: 'RPC', id, result });\n\t\t\t\t})\n\t\t\t\t.catch(e => {\n\t\t\t\t\tlet error = { message: e};\n\t\t\t\t\tif (e.stack) {\n\t\t\t\t\t\terror.message = e.message;\n\t\t\t\t\t\terror.stack = e.stack;\n\t\t\t\t\t\terror.name = e.name;\n\t\t\t\t\t}\n\t\t\t\t\tpostMessage({ type: 'RPC', id, error });\n\t\t\t\t});\n\t\t}\n\t});\n\tpostMessage({ type: 'RPC', method: 'ready' });\n}\n\nconst workerScript = '\\n' + Function.prototype.toString.call(workerSetup).replace(/(^.*\\{|\\}.*$|\\n\\s*)/g, '');\n\nexport default function rpcWorkerLoader(content) {\n\treturn content + workerScript;\n}\n"],"names":["workerSetup","addEventListener","e","data","type","method","id","params","f","p","__webpack_exports__","Promise","resolve","then","apply","reject","result","postMessage","catch","error","message","stack","name","const","workerScript","Function","prototype","toString","call","replace","rpcWorkerLoader","content"],"mappings":"AAAA;AAEA,SAASA,WAAT,GAAuB;EACtBC,gBAAgB,CAAC,SAAD,YAAaC;cACOA,CAAC,CAACC;IAA/BC;IAAMC;IAAQC;IAAIC;IAAxB,IAA2CC,CAA3C;QAA8CC,CAA9C;;QACIL,IAAI,KAAG,KAAP,IAAgBC,MAApB,EAA4B;UACtBG,CAAC,GAAGE,mBAAmB,CAACL,MAAD,CAA5B,EAAuC;QACtCI,CAAC,GAAGE,OAAO,CAACC,OAAR,GAAkBC,IAAlB,sBAA8BL,CAAC,CAACM,KAAF,CAAQJ,mBAAR,EAA6BH,MAA7B,IAA9B,CAAJ;OADD,MAGK;QACJE,CAAC,GAAGE,OAAO,CAACI,MAAR,CAAe,gBAAf,CAAJ;;;MAEDN,CAAC,CAACI,IAAF,WAAOG;QACLC,WAAW,CAAC;UAAEb,IAAI,EAAE,KAAR;cAAeE,EAAf;kBAAmBU;SAApB,CAAX;OADF,EAGEE,KAHF,WAGQhB;YACFiB,KAAK,GAAG;UAAEC,OAAO,EAAElB;SAAvB;;YACIA,CAAC,CAACmB,KAAN,EAAa;UACZF,KAAK,CAACC,OAAN,GAAgBlB,CAAC,CAACkB,OAAlB;UACAD,KAAK,CAACE,KAAN,GAAcnB,CAAC,CAACmB,KAAhB;UACAF,KAAK,CAACG,IAAN,GAAapB,CAAC,CAACoB,IAAf;;;QAEDL,WAAW,CAAC;UAAEb,IAAI,EAAE,KAAR;cAAeE,EAAf;iBAAmBa;SAApB,CAAX;OAVF;;GATc,CAAhB;EAuBAF,WAAW,CAAC;IAAEb,IAAI,EAAE,KAAR;IAAeC,MAAM,EAAE;GAAxB,CAAX;;;AAGDkB,IAAMC,YAAY,GAAG,OAAOC,QAAQ,CAACC,SAAT,CAAmBC,QAAnB,CAA4BC,IAA5B,CAAiC5B,WAAjC,EAA8C6B,OAA9C,CAAsD,sBAAtD,EAA8E,EAA9E,CAA5B;AAEA,AAAe,SAASC,eAAT,CAAyBC,OAAzB,EAAkC;SACzCA,OAAO,GAAGP,YAAjB;;;;;"}